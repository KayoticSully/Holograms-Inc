<!--<p id="notice"><%= notice %></p>-->
<% purchase = false %>

<p>
 <b>User:</b>
  <%= @order.user.first_name %>
</p>

<% if @order.purchased %>
<p><b>Your Order Number is: 25</b><br>Thank You for your Purchase!
</p>
<% end %>

<!--
<p>
  <b>OrderNumber:</b>
  <%= @order.total_price %>
</p>
-->

  <div>
  	<table border="0" cellspacing="0" class="table table-bordered table-striped"> 
  		<tbody>
  			<tr>
  				<!-- <th class="cartSelect" id="CartHeaderSelect">
  				<th><input type="checkbox" title="Select all items">
  					<label for="chkItemHeader"><span style="display: none;">Select all items</span></label>
					
  				</th>  cartQty cartDescription cartPrice -->
  				<th class="left" id="CartHeaderQty"> Qty. </th>
				<th class="left" id="CartHeaderDesc" style="width: 50%;"> Product(s) </th>
				<th  class="left" id="CartHeaderPrice"> Price </th>
				<th class="left" id="CartHeaderTotalPrice"> Total Price </th>
  			</tr>
			
	<% itemstotal = 0 %>
	
	<% itemsTotalPrice = 0 %>
	<% subTotal = 0 %>
	<% @order.order_items.each do |order_item| %>
  			<tr>
  				<td class="left"> 
					<strong><%= order_item.quantity %></strong>
					<% if !@order.purchased %>
					<div class="btn-group" >
						<%= link_to "+", "/orders/add/#{order_item.product.id}", :class => "btn btn-mini", :title => "Add 1" %>
						<%= link_to "-", "/orders/remove/#{order_item.product.id}", :class => "btn btn-mini", :title => "Add 1" %>
						<%= link_to "x", "/orders/removeall/#{order_item.product.id}", :class => "btn btn-mini", :title => "Add 1" %>
					</div>
					<% end %>
				</td>
  				<td class="left">
  					<%= link_to image_tag(order_item.product.image.url(:small)), order_item.product %>
  					<%= link_to order_item.product.name, order_item.product %>
  				</td>
				<td><strong>$<%= number_with_precision(order_item.product.price, :precision => 2) %></strong></td>
			<!-- <%= link_to number_with_precision(itemsTotalPrice = order_item.product.price * order_item.quantity,  :precision => 2), order_item.product %> -->
				<td class="left"><b>$<%= number_with_precision(itemsTotalPrice, :precision => 2) %></b></td>
  			</tr>
	<% itemstotal += order_item.quantity %>
	<% subTotal += itemsTotalPrice %>
	 

       <% end %>
       
      <tr>
	    <td><strong><%= itemstotal %></strong></td>
	    <td>&nbsp</td>
	    <td>&nbsp</td>
	    <td><b>Sub Total: $<%= number_with_precision(subTotal, :precision => 2) %></b></td>
	    <% @order.total_price = subTotal %>
      </tr>
			
	    </tbody>
       </table>    
    
  </div>

  <% if !@order.purchased %>
   <table>
      <tr>
	  <td>
	    
	    <%= link_to "Make Purchase", "/orders/purchase/#{@order.id}", :class => "btn btn-warning" %>
          </td>
          <td>&nbsp</td>
	  <td><%= link_to "Change Shipping Address OR Payment Method", "/users/#{@current_user.id}/edit", :class => "btn btn-warning" %></td>
	  <td>&nbsp</td>
          <td><%= link_to "Cancel Order", @order, :method => :delete, data:
	    { confirm: 'Are you sure?' }, :class => "btn btn-warning" %>
	  </td>
	  
      </tr>
      
   </table>
  <% end %>
  
<% shipTo = [] %>
<% index = 10 %>
<% shipTotal = 0.0 %>
<% shipSpeed = "" %>
  <%= @order.order_items.each do |order_item| %>
     <!-- <% shipTo = order_item.product.ship_prices_for(@current_user) %> -->
<script>
  window.onload = initForm
  function initForm() {
    document.getElementById("sSpeed").addEventListener
    document.getElementById("sSpeed").onchange = shipChoices;  
  }
  
  function shipChoices() {
    if(document.getElementById("sSpeed"))
    shipTotal = (shipTo[index][1])/100.0
    
    document.write(shipTotal)
  }
</script>
<br><div><b>Ship To:</b>
    <table>
      <tr>
	<td><%= @order.user.first_name %>&nbsp<%= @order.user.last_name %></td>
	
      </tr>
      <tr>
	<td><%= @order.user.address %>&nbsp&nbsp<%= @order.user.city %></td>
	<td>&nbsp</td>
      </tr>
      <tr>
	<td><%= @order.user.state %>&nbsp&nbsp<%= @order.user.zipcode %></td>
	<td>&nbsp</td>
      </tr>
      <tr>
	<td><%= @order.user.country %></td>
	<td>&nbsp</td>
      </tr>
      </tr>
      <tr>
	
	<% if !@order.purchased %>
	<td><b>Choose a Shipping speed:</b>
	  <label class="radio" for=sSpeed>
	    <input type="radio" name="optionsRadios" id="optionsRadios1" value="option1" onchange="shipChoices()">
	    <% index = 0 %>
	    <%= shipSpeed=shipTo[index][0] %> &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp
				&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp
			        &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp <b>$<%= shipTotal = (shipTo[0][1])/100.0 %></b>
	  <!-- </label>
	  <label class="radio"> -->
	  <br>
	  <input type="radio" name="optionsRadios" id="optionsRadios2" value="option2">
	   <% index = 1 %>
	   <%= shipSpeed=shipTo[index][0] %> --> Arrive by: <b><%= (Date.today + 3).to_s %>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp $<%= shipTotal = (shipTo[1][1])/100.0 %></b>
	   
	  <!-- </label>
	  <br>
	  <label class="radio"> -->
	  <br>
	  <input type="radio" name="optionsRadios" id="optionsRadios3" value="option3">
	  <% index = 2 %>
	  <%= shipSpeed=shipTo[index][0] %> --> Arrive by: <b><%= (Date.today + 2).to_s %>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp$<%= shipTotal = (shipTo[2][1])/100.0 %></b>
	  <!-- </label> 
	  <label class="radio"> -->
	  <br>
	  <input type="radio" name="optionsRadios" id="optionsRadios4" value="option4">
	  <% index = 3 %>
	  <%= shipSpeed=shipTo[index][0] %> --> Arrive by: <b><%= (Date.today + 2).to_s %>&nbsp&nbsp&nbsp$<%= shipTotal = (shipTo[3][1])/100.0 %></b>
	  <!-- </label>
	  <label class="radio"> -->
	  <br>
	  <input type="radio" name="optionsRadios" id="optionsRadios5" value="option5">
	  <% index = 4 %>  
	  <%= shipSpeed=shipTo[index][0] %> --> Arrive by: <b><%= (Date.today + 1).to_s %>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp$<%= shipTotal = (shipTo[4][1])/100.0 %></b>
	  <!-- </label>
	  <label class="radio"> -->
	  <br>
	  <input type="radio" name="optionsRadios" id="optionsRadios6" value="option6">
	  <%= shipSpeed=shipTo[5][0] %> -->&nbsp             &nbsp       &nbsp &nbsp &nbsp    Arrive by: <b><%= (Date.today + 1).to_s %>&nbsp
									    &nbsp&nbsp&nbsp&nbsp&nbsp$<%= shipTotal = (shipTo[5][1])/100.0 %></b>
	  <!-- </label>
	  <label class="radio"> -->
	  <br>
	  <input type="radio" name="optionsRadios" id="optionsRadios7" value="option7">
	  <% index = 6 %>  
	  <%= shipSpeed=shipTo[index][0] %> Arrive by: <b><%= (Date.today + 1).to_s %>&nbsp&nbsp&nbsp $<%= shipTotal = (shipTo[6][1])/100.0 %></b>
	  <!-- </label>
	  <label class="radio"> -->
	  <br>
	  <input type="radio" name="optionsRadios" id="optionsRadios8" value="option8" checked>
	   Pick Up at a UPS Store: &nbsp&nbsp&nbsp&nbspToday&nbsp
		    &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp<b><%= (Date.today + 0).to_s %>
		    &nbsp&nbsp&nbsp&nbsp  $<%= number_with_precision(shipTotal = 0/100.0, :precision => 2) %></b>
	  </label>
	  
	</td>
 <% end %>
 
	
	<td><!--
	  <tr><td>&nbsp</td><td>&nbsp</td><td>&nbsp</td><td>&nbsp</td><td>&nbsp</td><td>&nbsp</td><td>&nbsp</td><td>&nbsp</td><td>&nbsp</td>
	      <td>&nbsp</td><td>&nbsp</td><td>&nbsp</td><td>&nbsp</td><td>&nbsp</td><td>&nbsp</td><td>&nbsp</td><td>&nbsp</td><td>&nbsp</td>
	    <td class="right">Taxes:</td><td><b>$</b></td><td class="right"><b>25.00</b></td>
	  </tr>
	  -->
	  <tr><td>&nbsp</td><td>&nbsp</td><td>&nbsp</td><td>&nbsp</td><td>&nbsp</td><td>&nbsp</td><td>&nbsp</td><td>&nbsp</td><td>&nbsp</td>
	      <td>&nbsp</td><td>&nbsp</td><td>&nbsp</td><td>&nbsp</td><td>&nbsp</td><td>&nbsp</td><td>&nbsp</td><td>&nbsp</td><td>&nbsp</td>
	      
	    <td class="right">Shipping:</td><td><b>$</b></td><td class="right"><b><%= number_with_precision(shipTotal, :precision => 2) %></b></td>
	      
	  </tr>
	  <tr><td>&nbsp</td><td>&nbsp</td><td>&nbsp</td><td>&nbsp</td><td>&nbsp</td><td>&nbsp</td><td>&nbsp</td><td>&nbsp</td><td>&nbsp</td>
	      <td>&nbsp</td><td>&nbsp</td><td>&nbsp</td><td>&nbsp</td><td>&nbsp</td><td>&nbsp</td><td>&nbsp</td><td>&nbsp</td><td>&nbsp</td>
	    <td class="right">Total:</td><td><b>$</b></td><td class="right"><b><%= number_with_precision((shipTotal + subTotal), :precision => 2) %></b></td>
	  </tr>
	</td>
	
      </tr>
    </table>
  </div>
  
<br>
<% end %>
  
  
  <!-- <%= debug @order.order_items %> -->
    <% if !@order.purchased %>
      <%= link_to 'Edit', edit_order_path(@order), :class => "btn btn-mini" %> 
    <% end %>
  
     
  
   <%= link_to 'Continue Shopping', orders_path, :class => "btn btn-mini" %>
