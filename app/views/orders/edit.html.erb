<h4>My Shopping Cart</h4>

<br>

<!-- <h5>Items in this Order</h5> -->
<script>
      function add() {
	    //document.getElementById("cartQty").
	    
	    window.openDialog
      }
</script>

      
<div>
      <!--  -->
  	<table border="0" cellspacing="0" class="table-striped"> <caption>Items in this Order</caption>
  		<tbody>
  			<!-- <tr class="cartHeader"> </tr> -->
  			<tr>
  				<!-- <th class="cartSelect" id="CartHeaderSelect">
  				<th><input type="checkbox" title="Select all items">
  					<label for="chkItemHeader"><span style="display: none;">Select all items</span></label>
					
  				</th>  cartQty cartDescription cartPrice -->
  				<th class="left" id="CartHeaderQty"> Qty. </th>
				<th class="left" id="CartHeaderDesc" style="width: 50%;"> Product(s) </th>
				<th class="left" id="CartHeaderPrice"> Price </th>
				<!-- <th>&nbsp</th> -->
  			</tr>
			
	<% itemstotal = 0 %>
	<% itemsTotalPrice = 0 %>
	<% subTotal = 0 %>
	<% @order.order_items.each do |order_item| %>
  			<tr>
			      <!-- add = <%= link_to "/orders/add/#{order_item.product.id}" %> -->
  				<!-- <td class="cartSelect"> <input type="checkbox"></td> -->
  				<td class="left"> <input id="cartQty" class="input-mini" type="text" value= "<%= order_item.quantity %>" onchange= "add()">   </td>
  				<td class="left">
  					<%= link_to image_tag("/assets/#{order_item.product.image}", :class => "", :size => "50x50"), order_item.product.image %>
  					<%= link_to order_item.product.name, order_item.product %>
  				</td>
			<!-- <%= link_to number_with_precision(itemsTotalPrice = order_item.product.price * order_item.quantity,  :precision => 2), order_item.product %> -->
				<td class="left"><b>$<%= number_with_precision(itemsTotalPrice, :precision => 2) %></b></td>
				<td>
				    <table> 
					  <tr>
						<td>
						      <div class="btn-group" >
							    <%= link_to "Add 1", "/orders/add/#{order_item.product.id}", :class => "btn btn-mini" %>
							    <%= link_to "Remove 1", "/orders/remove/#{order_item.product.id}", :class => "btn btn-mini" %>
							    <%= link_to "Remove all", "/orders/removeall/#{order_item.product.id}", :class => "btn btn-mini" %>
							    <%= link_to "Change Qty to 5", "/orders/updateqty/#{order_item.product.id}/5", :class => "btn btn-mini" %>
						      </div>
						</td>						
					  </tr>
				    </table>
				</td> 
  			</tr>
	<% itemstotal += order_item.quantity %>
	<% subTotal += itemsTotalPrice %>
	 

       <% end %>
       
      <tr>
	    <!-- <td>&nbsp</td> -->
	    <td>&nbsp</td>
	    <td>&nbsp</td>
	    <td><b>Order SubTotal: $<%= number_with_precision(subTotal, :precision => 2) %></b></td>
	    <% @order.total_price = subTotal %>
      </tr>
			
      <tr><td></td></tr>
    
    <br> 
    
	    </tbody>
       </table>    

 <br>
 
   <table>
      <tr>
	    <td>
	    <% if itemstotal > 0 %>
	    <%= link_to "CheckOut", @order, :class => "btn btn-warning" %>
	    <% end %>
          </td><!--
          <td>&nbsp</td>
          <td><%= link_to "Continue Shopping", "/keywords/promoted" %></td> -->
      </tr>
   </table>

 <br>

 <br>
   <div>
      <%= link_to 'Continue Shopping', orders_path, :class => "btn btn-small" %> |
      <%= link_to "Cancel Order", @order, :method => :delete,
      data: { confirm: 'Are you sure?' }, :class => "btn btn-small btn-warning" %>
  </div>
</div>